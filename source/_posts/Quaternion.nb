(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     71014,       1756]
NotebookOptionsPosition[     69149,       1720]
NotebookOutlinePosition[     69593,       1738]
CellTagsIndexPosition[     69550,       1735]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<`*\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "II", " ", "JJ", " ", "KK", " ", 
    "\:4e3a\:4e09\:4e2a\:77e2\:91cf\:5355\:4f4d", " ", 
    "\:53e6\:4e00\:4e2a\:4e3a\:6570\:5b57", " ", "ToString", " ", "\:548c", 
    " ", "ToExpression\:662f\:4e24\:4e2a\:5f88\:597d\:7528\:7684\:51fd\:6570"}\
], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "QuaterToArray", " ", 
    "\:56db\:5143\:6570\:8f6c\:5316\:4e3a\:5411\:91cf\:5f62\:5f0f", 
    "\[IndentingNewLine]", "ScalarVector", " ", 
    "\:56db\:5143\:6570\:8f6c\:5316\:4e3a\:5b9e\:90e8", " ", 
    "\:590d\:90e8\:5f62\:5f0f", "\[IndentingNewLine]", "QuarterTimes", " ", 
    "\:56db\:5143\:6570\:4e58\:79ef", "\[IndentingNewLine]", 
    "QuaterConjugate", " ", "\:56db\:5143\:6570\:5171\:8f6d", 
    "\[IndentingNewLine]", "QuaterInverse", " ", 
    "\:56db\:5143\:6570\:6c42\:9006", "\[IndentingNewLine]", "QuaterToTrig", 
    " ", "\:56db\:5143\:6570\:8868\:793a\:8f6c\:52a8\:7684\:65f6\:5019\:5316\
\:4e3a\:4e09\:89d2\:5f62\:5f0f", "\[IndentingNewLine]", "TrigToQuater", " ", 
    "\:4e09\:89d2\:5f62\:5f0f\:7684\:8f6c\:52a8\:5316\:4e3a\:56db\:5143\:6570\
\:5f62\:5f0f", "\[IndentingNewLine]", "QuaterRotate", " ", 
    "\:7528\:56db\:5143\:6570\:6765\:8fdb\:884c\:8f6c\:52a8", 
    "\[IndentingNewLine]", 
    "\:57fa\:672c\:5f62\:5f0f\:4e3a\:5411\:91cf\:5355\:4f4d\:6c42\:548c\:5f62\
\:5f0f"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{
    RowBox[{"p1", "*", "II"}], "+", 
    RowBox[{"p2", " ", "JJ"}], "+", 
    RowBox[{"p3", " ", "KK"}], "+", "p0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q", "=", 
   RowBox[{
    RowBox[{"q1", "*", "II"}], "+", 
    RowBox[{"q2", " ", "JJ"}], "+", 
    RowBox[{"q3", " ", "KK"}], "+", "q0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "-", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"p", ",", 
      RowBox[{"{", 
       RowBox[{"II", ",", "JJ", ",", "KK"}], "}"}]}], "]"}], ".", 
    RowBox[{"{", 
     RowBox[{"II", ",", "JJ", ",", "KK"}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.880599063071403*^9, 3.8805990763152976`*^9}, {
   3.880599148751111*^9, 3.8805992346809444`*^9}, {3.8805993379333735`*^9, 
   3.8805995654534807`*^9}, {3.880599609534226*^9, 3.8805996254664927`*^9}, {
   3.880599678767484*^9, 3.8805997480339212`*^9}, {3.880599784880458*^9, 
   3.880599821779705*^9}, {3.8805998639114017`*^9, 3.8805999363997602`*^9}, {
   3.880600004831917*^9, 3.8806002666757994`*^9}, {3.880600311325901*^9, 
   3.880600413665085*^9}, {3.880600448349566*^9, 3.880600526664945*^9}, {
   3.880600608873979*^9, 3.880600617629695*^9}, {3.880600690072368*^9, 
   3.880600797302703*^9}, {3.880600841576805*^9, 3.880601211576098*^9}, 
   3.8806012546361675`*^9, {3.8806013884781923`*^9, 3.880601508737121*^9}, {
   3.8806016333297005`*^9, 3.880601736406918*^9}, {3.8806017944352174`*^9, 
   3.880601974886285*^9}, {3.8806020138569045`*^9, 3.8806021774671974`*^9}, {
   3.880602222833241*^9, 3.8806024202887926`*^9}, {3.8806024765438285`*^9, 
   3.8806024839782534`*^9}, 3.8806036541994534`*^9, {3.8806059238346443`*^9, 
   3.880605970152789*^9}, {3.880606007657332*^9, 3.8806061449851403`*^9}, {
   3.8806061929312553`*^9, 3.880606370784831*^9}, {3.8806064192613*^9, 
   3.880606471532483*^9}, {3.8806065119146924`*^9, 3.880606565531933*^9}, {
   3.8806066346229334`*^9, 3.880606645842348*^9}, {3.88060679561593*^9, 
   3.880606913151276*^9}, {3.880606943743864*^9, 3.8806069551666417`*^9}, {
   3.88060700691103*^9, 3.8806070796551065`*^9}, {3.8806071293244953`*^9, 
   3.8806073571714954`*^9}, {3.8806074156247644`*^9, 3.880607428547285*^9}, {
   3.880607491495983*^9, 3.880607564008848*^9}, {3.8806076636725607`*^9, 
   3.8806080379525642`*^9}, {3.8806080680459366`*^9, 
   3.8806081871101804`*^9}, {3.8806082726817102`*^9, 3.880608281495413*^9}, {
   3.880608338376096*^9, 3.8806084743199043`*^9}, {3.880608559142802*^9, 
   3.8806085838815775`*^9}, {3.880609852055793*^9, 3.88060987794119*^9}, {
   3.8806099144451103`*^9, 3.8806101725737076`*^9}, {3.880610209457802*^9, 
   3.880610210689172*^9}, {3.8806102810696287`*^9, 3.880610384508645*^9}, {
   3.880610596733289*^9, 3.8806108547777414`*^9}, {3.8806108934765406`*^9, 
   3.8806110027276063`*^9}, {3.8806110844698563`*^9, 3.880611276636324*^9}, {
   3.880611362852465*^9, 3.880611363416626*^9}},
 CellLabel->
  "In[339]:=",ExpressionUUID->"97714921-b194-4e47-a6f9-be6fd417cc6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**"}], "**********)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"QuaterToArray", "[", "x_", "]"}], ":=", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Coefficient", "[", 
        RowBox[{"x", ",", 
         RowBox[{"{", 
          RowBox[{"II", ",", "JJ", ",", "KK"}], "}"}]}], "]"}], ")"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", 
         RowBox[{
          RowBox[{"Coefficient", "[", 
           RowBox[{"x", ",", 
            RowBox[{"{", 
             RowBox[{"II", ",", "JJ", ",", "KK"}], "}"}]}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{"II", ",", "JJ", ",", "KK"}], "}"}]}]}], ")"}], "//", 
       "Simplify"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ScalarVector", "[", "x_", "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"QuaterToArray", "[", "x", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"QuaterToArray", "[", "x", "]"}], "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Range", "[", 
          RowBox[{"2", ",", "4"}], "]"}], ")"}]}]}], "}"}], "//", 
     "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QuaterTimes", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", "=", "x"}], ",", 
        RowBox[{"q", "=", "y"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sp", "=", 
        RowBox[{
         RowBox[{"ScalarVector", "[", "p", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vp", "=", 
        RowBox[{
         RowBox[{"ScalarVector", "[", "p", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sq", "=", 
        RowBox[{
         RowBox[{"ScalarVector", "[", "q", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"vq", "=", 
        RowBox[{
         RowBox[{"ScalarVector", "[", "q", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"sp", "*", "sq"}], "-", 
         RowBox[{"vp", ".", "vq"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sp", "*", "vq"}], "+", 
            RowBox[{"sq", "*", "vp"}], "+", 
            RowBox[{"Cross", "[", 
             RowBox[{"vp", ",", "vq"}], "]"}]}], ")"}], ".", 
          RowBox[{"{", 
           RowBox[{"II", ",", "JJ", ",", "KK"}], "}"}]}]}], "//", 
        "Simplify"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QuaterConjugate", "[", "x_", "]"}], ":=", 
    RowBox[{
     RowBox[{"QuaterToArray", "[", "x", "]"}], ".", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "II"}], ",", 
       RowBox[{"-", "JJ"}], ",", 
       RowBox[{"-", "KK"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QuaterInverse", "[", "x_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"QuaterConjugate", "[", "x", "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"QuaterToArray", "[", 
         RowBox[{"QuarterTimes", "[", 
          RowBox[{"x", ",", 
           RowBox[{"QuaterConjugate", "[", "x", "]"}]}], "]"}], "]"}], 
        "\[IndentingNewLine]", "//", "Total"}], ")"}]}], "//", "Simplify"}]}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QuaterToTrig", "[", "x_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"ArcTan", "[", 
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"ScalarVector", "[", "x", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "/", 
         RowBox[{
          RowBox[{"ScalarVector", "[", "x", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"Normalize", "[", 
       RowBox[{
        RowBox[{"ScalarVector", "[", "x", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TrigToQuater", "[", "x_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/", "2"}], "]"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "/", "2"}], "]"}], "*", 
           RowBox[{"Normalize", "[", 
            RowBox[{"x", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}], ".", 
         RowBox[{"{", 
          RowBox[{"II", ",", "JJ", ",", "KK"}], "}"}]}]}], "}"}], "//", 
      "Total"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QuaterRotate", "[", 
     RowBox[{"x_", ",", "u_"}], "]"}], ":=", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"QuaterTimes", "[", 
       RowBox[{
        RowBox[{"QuaterTimes", "[", 
         RowBox[{"u", ",", "x"}], "]"}], ",", 
        RowBox[{"QuaterConjugate", "[", "u", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"II", ",", "JJ", ",", "KK"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "(*", "******************************************************************************)"}\
], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<(\>\"", "<>", 
     RowBox[{"Nest", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "<>", "\"\<*\>\""}], "&"}], ",", "\"\<*\>\"", ",", 
       "79"}], "]"}], "<>", "\"\<)\>\""}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.880599063071403*^9, 3.8805990763152976`*^9}, {
   3.880599148751111*^9, 3.8805992346809444`*^9}, {3.8805993379333735`*^9, 
   3.8805995654534807`*^9}, {3.880599609534226*^9, 3.8805996254664927`*^9}, {
   3.880599678767484*^9, 3.8805997480339212`*^9}, {3.880599784880458*^9, 
   3.880599821779705*^9}, {3.8805998639114017`*^9, 3.8805999363997602`*^9}, {
   3.880600004831917*^9, 3.8806002666757994`*^9}, {3.880600311325901*^9, 
   3.880600413665085*^9}, {3.880600448349566*^9, 3.880600526664945*^9}, {
   3.880600608873979*^9, 3.880600617629695*^9}, {3.880600690072368*^9, 
   3.880600797302703*^9}, {3.880600841576805*^9, 3.880601211576098*^9}, 
   3.8806012546361675`*^9, {3.8806013884781923`*^9, 3.880601508737121*^9}, {
   3.8806016333297005`*^9, 3.880601736406918*^9}, {3.8806017944352174`*^9, 
   3.880601974886285*^9}, {3.8806020138569045`*^9, 3.8806021774671974`*^9}, {
   3.880602222833241*^9, 3.8806024202887926`*^9}, {3.8806024765438285`*^9, 
   3.8806024839782534`*^9}, 3.8806036541994534`*^9, {3.8806059238346443`*^9, 
   3.880605970152789*^9}, {3.880606007657332*^9, 3.8806061449851403`*^9}, {
   3.8806061929312553`*^9, 3.880606370784831*^9}, {3.8806064192613*^9, 
   3.880606471532483*^9}, {3.8806065119146924`*^9, 3.880606565531933*^9}, {
   3.8806066346229334`*^9, 3.880606645842348*^9}, {3.88060679561593*^9, 
   3.880606913151276*^9}, {3.880606943743864*^9, 3.8806069551666417`*^9}, {
   3.88060700691103*^9, 3.8806070796551065`*^9}, {3.8806071293244953`*^9, 
   3.8806073571714954`*^9}, {3.8806074156247644`*^9, 3.880607428547285*^9}, {
   3.880607491495983*^9, 3.880607564008848*^9}, {3.8806076636725607`*^9, 
   3.8806080379525642`*^9}, {3.8806080680459366`*^9, 
   3.8806081871101804`*^9}, {3.8806082726817102`*^9, 3.880608281495413*^9}, {
   3.880608338376096*^9, 3.8806084743199043`*^9}, {3.880608559142802*^9, 
   3.8806085838815775`*^9}, {3.880609852055793*^9, 3.88060987794119*^9}, {
   3.8806099144451103`*^9, 3.8806101725737076`*^9}, {3.880610209457802*^9, 
   3.880610210689172*^9}, {3.8806102810696287`*^9, 3.880610384508645*^9}, {
   3.880610596733289*^9, 3.8806108547777414`*^9}, {3.8806108934765406`*^9, 
   3.8806110027276063`*^9}, {3.8806110844698563`*^9, 3.880611276636324*^9}, {
   3.880611362852465*^9, 3.8806113671263313`*^9}},
 CellLabel->
  "In[343]:=",ExpressionUUID->"a82c8a22-6c33-4911-b414-4ef9cd33e49b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"y", "=", "1"}]}], ";", 
  RowBox[{"z", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"\[Alpha]_", ",", "x_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ScalarVector", "[", 
       RowBox[{"QuaterRotate", "[", 
        RowBox[{
         RowBox[{"x", ".", 
          RowBox[{"{", 
           RowBox[{"II", ",", "JJ", ",", "KK"}], "}"}]}], ",", 
         RowBox[{"TrigToQuater", "[", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "p"}], "}"}], "]"}]}], "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\[Alpha]", "\[Element]", "Reals"}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\:6c42\:4e09\:4e2a\:8f6c\:8f74", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axis1", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axis2", "=", 
   RowBox[{"f", "[", 
    RowBox[{"\[Alpha]", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axis3", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"\[Beta]", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"f", "[", 
        RowBox[{"\[Alpha]", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Alpha]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Beta]", "\[Element]", "Reals"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[Gamma]", ",", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"\[Beta]", ",", 
            RowBox[{"f", "[", 
             RowBox[{"\[Alpha]", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
            RowBox[{"f", "[", 
             RowBox[{"\[Alpha]", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
          ",", 
          RowBox[{"Assumptions", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Alpha]", "\[Element]", "Reals"}], ",", 
             RowBox[{"\[Beta]", "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], 
        ",", "axis3"}], "]"}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Alpha]", "\[Element]", "Reals"}], ",", 
         RowBox[{"\[Beta]", "\[Element]", "Reals"}], ",", 
         RowBox[{"\[Gamma]", "\[Element]", "Reals"}]}], "}"}]}]}], "]"}]}], "//",
    "MatrixForm"}], " ", 
  RowBox[{
  "(*", "\:56db\:5143\:6570\:4f9d\:6b21\:65cb\:8f6c", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"EulerMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], "]"}], "//",
      "TrigReduce"}], "//", "Simplify"}], "//", "MatrixForm"}], 
  RowBox[{"(*", "\:6b27\:62c9\:65cb\:8f6c\:77e9\:9635", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[Gamma]", ",", 
      RowBox[{"f", "[", 
       RowBox[{"\[Beta]", ",", 
        RowBox[{"f", "[", 
         RowBox[{"\[Alpha]", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"f", "[", 
         RowBox[{"\[Alpha]", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"f", "[", 
       RowBox[{"\[Beta]", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], "]"}], "//", 
    "Simplify"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"ScalarVector", "[", 
     RowBox[{"QuaterRotate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"x", " ", "II"}], "+", 
        RowBox[{"y", " ", "JJ"}], "+", 
        RowBox[{"z", " ", "KK"}]}], ",", 
       RowBox[{"q0", "+", 
        RowBox[{"q1", " ", "II"}], "+", 
        RowBox[{"q2", " ", "JJ"}], "+", 
        RowBox[{"q3", " ", "KK"}]}]}], "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.880599063071403*^9, 3.8805990763152976`*^9}, {
   3.880599148751111*^9, 3.8805992346809444`*^9}, {3.8805993379333735`*^9, 
   3.8805995654534807`*^9}, {3.880599609534226*^9, 3.8805996254664927`*^9}, {
   3.880599678767484*^9, 3.8805997480339212`*^9}, {3.880599784880458*^9, 
   3.880599821779705*^9}, {3.8805998639114017`*^9, 3.8805999363997602`*^9}, {
   3.880600004831917*^9, 3.8806002666757994`*^9}, {3.880600311325901*^9, 
   3.880600413665085*^9}, {3.880600448349566*^9, 3.880600526664945*^9}, {
   3.880600608873979*^9, 3.880600617629695*^9}, {3.880600690072368*^9, 
   3.880600797302703*^9}, {3.880600841576805*^9, 3.880601211576098*^9}, 
   3.8806012546361675`*^9, {3.8806013884781923`*^9, 3.880601508737121*^9}, {
   3.8806016333297005`*^9, 3.880601736406918*^9}, {3.8806017944352174`*^9, 
   3.880601974886285*^9}, {3.8806020138569045`*^9, 3.8806021774671974`*^9}, {
   3.880602222833241*^9, 3.8806024202887926`*^9}, {3.8806024765438285`*^9, 
   3.8806024839782534`*^9}, 3.8806036541994534`*^9, {3.8806059238346443`*^9, 
   3.880605970152789*^9}, {3.880606007657332*^9, 3.8806061449851403`*^9}, {
   3.8806061929312553`*^9, 3.880606370784831*^9}, {3.8806064192613*^9, 
   3.880606471532483*^9}, {3.8806065119146924`*^9, 3.880606565531933*^9}, {
   3.8806066346229334`*^9, 3.880606645842348*^9}, {3.88060679561593*^9, 
   3.880606913151276*^9}, {3.880606943743864*^9, 3.8806069551666417`*^9}, {
   3.88060700691103*^9, 3.8806070796551065`*^9}, {3.8806071293244953`*^9, 
   3.8806073571714954`*^9}, {3.8806074156247644`*^9, 3.880607428547285*^9}, {
   3.880607491495983*^9, 3.880607564008848*^9}, {3.8806076636725607`*^9, 
   3.8806080379525642`*^9}, {3.8806080680459366`*^9, 
   3.8806081871101804`*^9}, {3.8806082726817102`*^9, 3.880608281495413*^9}, {
   3.880608338376096*^9, 3.8806084743199043`*^9}, {3.880608559142802*^9, 
   3.8806085838815775`*^9}, {3.880609852055793*^9, 3.88060987794119*^9}, {
   3.8806099144451103`*^9, 3.8806101725737076`*^9}, {3.880610209457802*^9, 
   3.880610210689172*^9}, {3.8806102810696287`*^9, 3.880610384508645*^9}, {
   3.880610596733289*^9, 3.8806108547777414`*^9}, {3.8806108934765406`*^9, 
   3.8806110027276063`*^9}, {3.8806110844698563`*^9, 3.880611198708252*^9}, {
   3.8806113836053195`*^9, 3.8806113975879655`*^9}, {3.880611498492002*^9, 
   3.8806117029196777`*^9}, {3.8806120106858683`*^9, 3.88061201517549*^9}, {
   3.880612257570617*^9, 3.8806123093059645`*^9}, {3.880612375277933*^9, 
   3.880612395298952*^9}, {3.8806124382153068`*^9, 3.880612446627692*^9}, {
   3.8806125025277886`*^9, 3.8806125066046963`*^9}, {3.8806125566205425`*^9, 
   3.8806126380071955`*^9}, {3.8806180923617134`*^9, 3.880618100237953*^9}},
 CellLabel->
  "In[352]:=",ExpressionUUID->"8be6f0e6-b21e-40b7-b26f-84a5a4cddce5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], " ", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Beta]", "]"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], 
      RowBox[{
       RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Beta]", "]"}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], " ", 
       RowBox[{"Sin", "[", "\[Beta]", "]"}]}], 
      RowBox[{
       RowBox[{"Sin", "[", "\[Beta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], 
      RowBox[{"Cos", "[", "\[Beta]", "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.880600744171708*^9, 3.8806007978181725`*^9}, 
   3.8806009854693203`*^9, {3.880601096440254*^9, 3.880601143838086*^9}, 
   3.880601179768834*^9, 3.880601211846609*^9, 3.8806012552200146`*^9, {
   3.880601428516982*^9, 3.880601509068894*^9}, 3.8806017367587185`*^9, {
   3.8806018499917917`*^9, 3.8806019297015505`*^9}, 3.8806019753941865`*^9, {
   3.880602051573181*^9, 3.8806021777651443`*^9}, {3.880602232756917*^9, 
   3.880602271138346*^9}, {3.8806060499545608`*^9, 3.8806060558201303`*^9}, {
   3.880606102029952*^9, 3.88060611143573*^9}, 3.880606145325199*^9, 
   3.8806062018169746`*^9, {3.8806062444310617`*^9, 3.8806063371179905`*^9}, {
   3.8806064227943735`*^9, 3.8806064728568473`*^9}, {3.8806065141199193`*^9, 
   3.880606558067066*^9}, 3.8806066379301805`*^9, {3.880606812660287*^9, 
   3.880606815361719*^9}, 3.8806068642394476`*^9, {3.8806068963111677`*^9, 
   3.88060691354125*^9}, {3.880606945680176*^9, 3.8806069555775213`*^9}, {
   3.880607007338079*^9, 3.8806070528529387`*^9}, {3.8806071952985935`*^9, 
   3.880607198919348*^9}, 3.8806072562036676`*^9, {3.8806072892237825`*^9, 
   3.8806073575394473`*^9}, {3.8806075210634813`*^9, 3.880607552079301*^9}, {
   3.880607694327933*^9, 3.880607714792552*^9}, {3.8806078927052293`*^9, 
   3.8806080690779266`*^9}, {3.8806081077014503`*^9, 
   3.8806081882105837`*^9}, {3.8806082489789615`*^9, 
   3.8806082887603045`*^9}, {3.8806083450536566`*^9, 3.8806084750090027`*^9}, 
   3.8806101947650614`*^9, {3.8806102859683857`*^9, 3.8806103034357586`*^9}, {
   3.8806107050532646`*^9, 3.880610716847189*^9}, 3.8806107476320615`*^9, {
   3.880610783745202*^9, 3.8806108193429265`*^9}, 3.8806108494877996`*^9, 
   3.880610888636158*^9, 3.880610940353698*^9, {3.8806109741130896`*^9, 
   3.8806109936291046`*^9}, 3.880611190451479*^9, {3.8806115795016756`*^9, 
   3.880611631424926*^9}, {3.8806116664120636`*^9, 3.880611703215846*^9}, 
   3.8806120157572966`*^9, {3.8806122533777294`*^9, 3.8806122602254*^9}, {
   3.880612296966198*^9, 3.8806123097866426`*^9}, 3.8806123965006733`*^9, {
   3.880612489237735*^9, 3.8806125149913683`*^9}, 3.880612665413314*^9, 
   3.8806129913245125`*^9, 3.8806151539884334`*^9, 3.881199644270982*^9, 
   3.8865355079521947`*^9},
 CellLabel->
  "Out[358]//MatrixForm=",ExpressionUUID->"4f52666c-b6cd-412d-a8c4-\
7fab02d166ce"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], " ", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Beta]", "]"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Beta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Gamma]", "]"}]}]}], 
      RowBox[{
       RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Beta]", "]"}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Gamma]", "]"}]}], " ", 
       RowBox[{"Sin", "[", "\[Beta]", "]"}]}], 
      RowBox[{
       RowBox[{"Sin", "[", "\[Beta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Gamma]", "]"}]}], 
      RowBox[{"Cos", "[", "\[Beta]", "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.880600744171708*^9, 3.8806007978181725`*^9}, 
   3.8806009854693203`*^9, {3.880601096440254*^9, 3.880601143838086*^9}, 
   3.880601179768834*^9, 3.880601211846609*^9, 3.8806012552200146`*^9, {
   3.880601428516982*^9, 3.880601509068894*^9}, 3.8806017367587185`*^9, {
   3.8806018499917917`*^9, 3.8806019297015505`*^9}, 3.8806019753941865`*^9, {
   3.880602051573181*^9, 3.8806021777651443`*^9}, {3.880602232756917*^9, 
   3.880602271138346*^9}, {3.8806060499545608`*^9, 3.8806060558201303`*^9}, {
   3.880606102029952*^9, 3.88060611143573*^9}, 3.880606145325199*^9, 
   3.8806062018169746`*^9, {3.8806062444310617`*^9, 3.8806063371179905`*^9}, {
   3.8806064227943735`*^9, 3.8806064728568473`*^9}, {3.8806065141199193`*^9, 
   3.880606558067066*^9}, 3.8806066379301805`*^9, {3.880606812660287*^9, 
   3.880606815361719*^9}, 3.8806068642394476`*^9, {3.8806068963111677`*^9, 
   3.88060691354125*^9}, {3.880606945680176*^9, 3.8806069555775213`*^9}, {
   3.880607007338079*^9, 3.8806070528529387`*^9}, {3.8806071952985935`*^9, 
   3.880607198919348*^9}, 3.8806072562036676`*^9, {3.8806072892237825`*^9, 
   3.8806073575394473`*^9}, {3.8806075210634813`*^9, 3.880607552079301*^9}, {
   3.880607694327933*^9, 3.880607714792552*^9}, {3.8806078927052293`*^9, 
   3.8806080690779266`*^9}, {3.8806081077014503`*^9, 
   3.8806081882105837`*^9}, {3.8806082489789615`*^9, 
   3.8806082887603045`*^9}, {3.8806083450536566`*^9, 3.8806084750090027`*^9}, 
   3.8806101947650614`*^9, {3.8806102859683857`*^9, 3.8806103034357586`*^9}, {
   3.8806107050532646`*^9, 3.880610716847189*^9}, 3.8806107476320615`*^9, {
   3.880610783745202*^9, 3.8806108193429265`*^9}, 3.8806108494877996`*^9, 
   3.880610888636158*^9, 3.880610940353698*^9, {3.8806109741130896`*^9, 
   3.8806109936291046`*^9}, 3.880611190451479*^9, {3.8806115795016756`*^9, 
   3.880611631424926*^9}, {3.8806116664120636`*^9, 3.880611703215846*^9}, 
   3.8806120157572966`*^9, {3.8806122533777294`*^9, 3.8806122602254*^9}, {
   3.880612296966198*^9, 3.8806123097866426`*^9}, 3.8806123965006733`*^9, {
   3.880612489237735*^9, 3.8806125149913683`*^9}, 3.880612665413314*^9, 
   3.8806129913245125`*^9, 3.8806151539884334`*^9, 3.881199644270982*^9, 
   3.886535508372136*^9},
 CellLabel->
  "Out[359]//MatrixForm=",ExpressionUUID->"4834ba28-a9f8-4310-96bb-\
5d21867a6e7d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q1", "2"], "-", 
       SuperscriptBox["q2", "2"], "-", 
       SuperscriptBox["q3", "2"]}], 
      RowBox[{
       RowBox[{"2", " ", "q1", " ", "q2"}], "-", 
       RowBox[{"2", " ", "q0", " ", "q3"}]}], 
      RowBox[{
       RowBox[{"2", " ", "q0", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q1", " ", "q3"}]}]},
     {
      RowBox[{
       RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q0", " ", "q3"}]}], 
      RowBox[{
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"], "-", 
       SuperscriptBox["q3", "2"]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0", " ", "q1"}], "+", 
       RowBox[{"2", " ", "q2", " ", "q3"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q1", " ", "q3"}]}], 
      RowBox[{
       RowBox[{"2", " ", "q0", " ", "q1"}], "+", 
       RowBox[{"2", " ", "q2", " ", "q3"}]}], 
      RowBox[{
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"], "-", 
       SuperscriptBox["q2", "2"], "+", 
       SuperscriptBox["q3", "2"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.880600744171708*^9, 3.8806007978181725`*^9}, 
   3.8806009854693203`*^9, {3.880601096440254*^9, 3.880601143838086*^9}, 
   3.880601179768834*^9, 3.880601211846609*^9, 3.8806012552200146`*^9, {
   3.880601428516982*^9, 3.880601509068894*^9}, 3.8806017367587185`*^9, {
   3.8806018499917917`*^9, 3.8806019297015505`*^9}, 3.8806019753941865`*^9, {
   3.880602051573181*^9, 3.8806021777651443`*^9}, {3.880602232756917*^9, 
   3.880602271138346*^9}, {3.8806060499545608`*^9, 3.8806060558201303`*^9}, {
   3.880606102029952*^9, 3.88060611143573*^9}, 3.880606145325199*^9, 
   3.8806062018169746`*^9, {3.8806062444310617`*^9, 3.8806063371179905`*^9}, {
   3.8806064227943735`*^9, 3.8806064728568473`*^9}, {3.8806065141199193`*^9, 
   3.880606558067066*^9}, 3.8806066379301805`*^9, {3.880606812660287*^9, 
   3.880606815361719*^9}, 3.8806068642394476`*^9, {3.8806068963111677`*^9, 
   3.88060691354125*^9}, {3.880606945680176*^9, 3.8806069555775213`*^9}, {
   3.880607007338079*^9, 3.8806070528529387`*^9}, {3.8806071952985935`*^9, 
   3.880607198919348*^9}, 3.8806072562036676`*^9, {3.8806072892237825`*^9, 
   3.8806073575394473`*^9}, {3.8806075210634813`*^9, 3.880607552079301*^9}, {
   3.880607694327933*^9, 3.880607714792552*^9}, {3.8806078927052293`*^9, 
   3.8806080690779266`*^9}, {3.8806081077014503`*^9, 
   3.8806081882105837`*^9}, {3.8806082489789615`*^9, 
   3.8806082887603045`*^9}, {3.8806083450536566`*^9, 3.8806084750090027`*^9}, 
   3.8806101947650614`*^9, {3.8806102859683857`*^9, 3.8806103034357586`*^9}, {
   3.8806107050532646`*^9, 3.880610716847189*^9}, 3.8806107476320615`*^9, {
   3.880610783745202*^9, 3.8806108193429265`*^9}, 3.8806108494877996`*^9, 
   3.880610888636158*^9, 3.880610940353698*^9, {3.8806109741130896`*^9, 
   3.8806109936291046`*^9}, 3.880611190451479*^9, {3.8806115795016756`*^9, 
   3.880611631424926*^9}, {3.8806116664120636`*^9, 3.880611703215846*^9}, 
   3.8806120157572966`*^9, {3.8806122533777294`*^9, 3.8806122602254*^9}, {
   3.880612296966198*^9, 3.8806123097866426`*^9}, 3.8806123965006733`*^9, {
   3.880612489237735*^9, 3.8806125149913683`*^9}, 3.880612665413314*^9, 
   3.8806129913245125`*^9, 3.8806151539884334`*^9, 3.881199644270982*^9, 
   3.886535508422002*^9},
 CellLabel->
  "Out[360]//MatrixForm=",ExpressionUUID->"95e96177-a958-431d-8e8d-\
3fa70e7d3d74"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"QuaTra", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"x0", ",", "y0", ",", "z0"}], "}"}]}], "]"}], "&"}], "/@", 
      RowBox[{
       RowBox[{"ScalarVector", "[", 
        RowBox[{"QuaterRotate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x0", " ", "II"}], "+", 
           RowBox[{"y0", " ", "JJ"}], "+", 
           RowBox[{"z0", " ", "KK"}]}], ",", 
          RowBox[{
           RowBox[{"q0", "[", "s", "]"}], "-", 
           RowBox[{
            RowBox[{"q1", "[", "s", "]"}], " ", "II"}], "-", 
           RowBox[{
            RowBox[{"q2", "[", "s", "]"}], " ", "JJ"}], "-", 
           RowBox[{
            RowBox[{"q3", "[", "s", "]"}], " ", "KK"}]}]}], "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"r", "'"}], "[", "s", "]"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"QuaTra", ",", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"q0", "[", "s", "]"}], "^", "2"}], "+", 
            RowBox[{
             RowBox[{"q1", "[", "s", "]"}], "^", "2"}], "+", 
            RowBox[{
             RowBox[{"q2", "[", "s", "]"}], "^", "2"}], "+", 
            RowBox[{
             RowBox[{"q3", "[", "s", "]"}], "^", "2"}]}], "==", "1"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"q0", "[", "s", "]"}], " ", 
             RowBox[{
              RowBox[{"q0", "'"}], "[", "s", "]"}]}], "+", 
            RowBox[{
             RowBox[{"q1", "[", "s", "]"}], " ", 
             RowBox[{
              RowBox[{"q1", "'"}], "[", "s", "]"}]}], "+", 
            RowBox[{
             RowBox[{"q2", "[", "s", "]"}], " ", 
             RowBox[{
              RowBox[{"q2", "'"}], "[", "s", "]"}]}], "+", 
            RowBox[{
             RowBox[{"q3", "[", "s", "]"}], " ", 
             RowBox[{
              RowBox[{"q3", "'"}], "[", "s", "]"}]}]}], "==", "0"}]}], 
         "}"}]}]}], "]"}], "//", "Simplify"}], "//", "MatrixForm"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"QuaTra", ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1"}], "}"}]}], "]"}], ".", 
       RowBox[{"Transpose", "[", "QuaTra", "]"}]}], ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"q0", "[", "s", "]"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"q1", "[", "s", "]"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"q2", "[", "s", "]"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"q3", "[", "s", "]"}], "^", "2"}]}], "==", "1"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"q0", "[", "s", "]"}], " ", 
            RowBox[{
             RowBox[{"q0", "'"}], "[", "s", "]"}]}], "+", 
           RowBox[{
            RowBox[{"q1", "[", "s", "]"}], " ", 
            RowBox[{
             RowBox[{"q1", "'"}], "[", "s", "]"}]}], "+", 
           RowBox[{
            RowBox[{"q2", "[", "s", "]"}], " ", 
            RowBox[{
             RowBox[{"q2", "'"}], "[", "s", "]"}]}], "+", 
           RowBox[{
            RowBox[{"q3", "[", "s", "]"}], " ", 
            RowBox[{
             RowBox[{"q3", "'"}], "[", "s", "]"}]}]}], "==", "0"}]}], 
        "}"}]}]}], "]"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8806137198995123`*^9, 3.8806137240090256`*^9}, {
   3.8806140784633293`*^9, 3.8806141032234173`*^9}, {3.8806141348692727`*^9, 
   3.8806142108671494`*^9}, {3.8806147634864445`*^9, 3.880614848758919*^9}, {
   3.8806149890272713`*^9, 3.8806151305780745`*^9}, {3.8806151717336864`*^9, 
   3.880615306072781*^9}, {3.880615342075923*^9, 3.8806153607060785`*^9}, {
   3.8806154823284965`*^9, 3.8806154845372467`*^9}, {3.8806169029097657`*^9, 
   3.8806169277713604`*^9}, 3.8865354855496063`*^9, {3.88653551724494*^9, 
   3.88653557543911*^9}},
 CellLabel->
  "In[379]:=",ExpressionUUID->"bfc948b6-7d70-40f7-a763-e20389ce82e8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"q2", "[", "s", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"q3", "[", "s", "]"}], "2"]}]}], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"q1", "[", "s", "]"}], " ", 
          RowBox[{"q2", "[", "s", "]"}]}], "+", 
         RowBox[{
          RowBox[{"q0", "[", "s", "]"}], " ", 
          RowBox[{"q3", "[", "s", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"q0", "[", "s", "]"}], " ", 
        RowBox[{"q2", "[", "s", "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"q1", "[", "s", "]"}], " ", 
        RowBox[{"q3", "[", "s", "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"q1", "[", "s", "]"}], " ", 
        RowBox[{"q2", "[", "s", "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"q0", "[", "s", "]"}], " ", 
        RowBox[{"q3", "[", "s", "]"}]}]}], 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"q1", "[", "s", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"q3", "[", "s", "]"}], "2"]}]}], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"q0", "[", "s", "]"}], " ", 
          RowBox[{"q1", "[", "s", "]"}]}], "+", 
         RowBox[{
          RowBox[{"q2", "[", "s", "]"}], " ", 
          RowBox[{"q3", "[", "s", "]"}]}]}], ")"}]}]},
     {
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"q0", "[", "s", "]"}], " ", 
          RowBox[{"q2", "[", "s", "]"}]}], "+", 
         RowBox[{
          RowBox[{"q1", "[", "s", "]"}], " ", 
          RowBox[{"q3", "[", "s", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"q0", "[", "s", "]"}], " ", 
        RowBox[{"q1", "[", "s", "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"q2", "[", "s", "]"}], " ", 
        RowBox[{"q3", "[", "s", "]"}]}]}], 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"q1", "[", "s", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"q2", "[", "s", "]"}], "2"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8806136929435987`*^9, 3.880613724243392*^9, {3.880614090463347*^9, 
   3.880614103676178*^9}, 3.8806141351766987`*^9, {3.880614165590876*^9, 
   3.8806142111327105`*^9}, 3.8806147692487135`*^9, 3.880614815725567*^9, 
   3.880614849150606*^9, {3.8806150032916384`*^9, 3.8806150143932686`*^9}, {
   3.880615052131987*^9, 3.8806150821114874`*^9}, {3.880615113170168*^9, 
   3.880615123140093*^9}, {3.8806151542696185`*^9, 3.8806151797224092`*^9}, {
   3.8806152149214306`*^9, 3.8806152181809177`*^9}, {3.8806152659173245`*^9, 
   3.8806153065254545`*^9}, 3.8806153613149147`*^9, 3.88061548559118*^9, 
   3.8806169206575956`*^9, 3.881199653493167*^9, 3.881199716571946*^9, {
   3.886535486114145*^9, 3.886535579078628*^9}},
 CellLabel->
  "Out[380]//MatrixForm=",ExpressionUUID->"8f509f4c-3890-4646-adff-\
1a433f08f029"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"q3", "[", "s", "]"}]}], " ", 
          RowBox[{
           SuperscriptBox["q0", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "+", 
         RowBox[{
          RowBox[{"q2", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q1", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "-", 
         RowBox[{
          RowBox[{"q1", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q2", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "+", 
         RowBox[{
          RowBox[{"q0", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q3", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"q2", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q0", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "+", 
         RowBox[{
          RowBox[{"q3", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q1", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "-", 
         RowBox[{
          RowBox[{"q0", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q2", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "-", 
         RowBox[{
          RowBox[{"q1", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q3", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}]},
     {
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"q3", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q0", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "-", 
         RowBox[{
          RowBox[{"q2", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q1", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "+", 
         RowBox[{
          RowBox[{"q1", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q2", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "-", 
         RowBox[{
          RowBox[{"q0", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q3", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}], "0", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"q1", "[", "s", "]"}]}], " ", 
          RowBox[{
           SuperscriptBox["q0", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "+", 
         RowBox[{
          RowBox[{"q0", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q1", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "+", 
         RowBox[{
          RowBox[{"q3", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q2", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "-", 
         RowBox[{
          RowBox[{"q2", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q3", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}]},
     {
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"q2", "[", "s", "]"}]}], " ", 
          RowBox[{
           SuperscriptBox["q0", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "-", 
         RowBox[{
          RowBox[{"q3", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q1", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "+", 
         RowBox[{
          RowBox[{"q0", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q2", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "+", 
         RowBox[{
          RowBox[{"q1", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q3", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"q1", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q0", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "-", 
         RowBox[{
          RowBox[{"q0", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q1", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "-", 
         RowBox[{
          RowBox[{"q3", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q2", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}], "+", 
         RowBox[{
          RowBox[{"q2", "[", "s", "]"}], " ", 
          RowBox[{
           SuperscriptBox["q3", "\[Prime]",
            MultilineFunction->None], "[", "s", "]"}]}]}], ")"}]}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8806136929435987`*^9, 3.880613724243392*^9, {3.880614090463347*^9, 
   3.880614103676178*^9}, 3.8806141351766987`*^9, {3.880614165590876*^9, 
   3.8806142111327105`*^9}, 3.8806147692487135`*^9, 3.880614815725567*^9, 
   3.880614849150606*^9, {3.8806150032916384`*^9, 3.8806150143932686`*^9}, {
   3.880615052131987*^9, 3.8806150821114874`*^9}, {3.880615113170168*^9, 
   3.880615123140093*^9}, {3.8806151542696185`*^9, 3.8806151797224092`*^9}, {
   3.8806152149214306`*^9, 3.8806152181809177`*^9}, {3.8806152659173245`*^9, 
   3.8806153065254545`*^9}, 3.8806153613149147`*^9, 3.88061548559118*^9, 
   3.8806169206575956`*^9, 3.881199653493167*^9, 3.881199716571946*^9, {
   3.886535486114145*^9, 3.88653557909356*^9}},
 CellLabel->
  "Out[381]//MatrixForm=",ExpressionUUID->"9ec6c715-a488-4a15-b144-\
c26ae541c48c"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.880617835193926*^9, 3.880617880480398*^9}},
 CellLabel->
  "In[363]:=",ExpressionUUID->"2add9f40-5bec-4cf7-b74d-0d22059150f5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ppp", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ppp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ppp", "[", 
     RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6", ",", "7", ",", "8"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"EulerMatrix", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Alpha]", "[", "s", "]"}], ",", 
         RowBox[{"\[Beta]", "[", "s", "]"}], ",", 
         RowBox[{"\[Gamma]", "[", "s", "]"}]}], "}"}], ",", "p"}], "]"}], "//",
      "TrigReduce"}], "//", "Simplify"}], "//", "MatrixForm"}], 
  RowBox[{
  "(*", "\:6b27\:62c9\:65cb\:8f6c\:77e9\:9635", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"EulerMatrix", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Alpha]", "[", "s", "]"}], ",", 
              RowBox[{"\[Beta]", "[", "s", "]"}], ",", 
              RowBox[{"\[Gamma]", "[", "s", "]"}]}], "}"}], ",", "#"}], "]"}],
           ",", "s"}], "]"}], ".", 
        RowBox[{"Transpose", "[", 
         RowBox[{"EulerMatrix", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Alpha]", "[", "s", "]"}], ",", 
             RowBox[{"\[Beta]", "[", "s", "]"}], ",", 
             RowBox[{"\[Gamma]", "[", "s", "]"}]}], "}"}], ",", "#"}], "]"}], 
         "]"}]}], "&"}], "/@", "ppp"}], "//", "Simplify"}], "//", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", "MatrixForm"}], "//", 
  "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.880616933956913*^9, 3.880616951803268*^9}, {
  3.8806169840727496`*^9, 3.8806170458680525`*^9}, {3.8806171185955963`*^9, 
  3.8806171535170493`*^9}, {3.8806171855016727`*^9, 3.8806172159293995`*^9}, {
  3.8806172591319065`*^9, 3.8806173147470217`*^9}, {3.8806173739929385`*^9, 
  3.8806173889952254`*^9}, {3.880617458659937*^9, 3.880617480923624*^9}, {
  3.880617593320613*^9, 3.8806177383813043`*^9}, {3.880617881964752*^9, 
  3.8806179088159704`*^9}, {3.8806179450766892`*^9, 3.88061795627455*^9}},
 CellLabel->
  "In[364]:=",ExpressionUUID->"242df851-d0c3-4e0c-81b5-7c03dee13686"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8806176669280453`*^9, 3.880617738680109*^9}, {
   3.8806178863854094`*^9, 3.8806179092439923`*^9}, {3.8806179516717224`*^9, 
   3.880617956634055*^9}, {3.881199667400702*^9, 3.8811996843222246`*^9}, 
   3.881199721033497*^9, 3.886535508774028*^9},
 CellLabel->
  "Out[365]=",ExpressionUUID->"ae372120-a7a8-4a97-bc25-e74b4204fcef"],

Cell[BoxData[
 TemplateBox[{
  "EulerMatrix", "axes", 
   "\"\\!\\(\\*RowBox[{\\\"p0\\\", \\\"+\\\", RowBox[{\\\"II\\\", \\\" \\\", \
\\\"p1\\\"}], \\\"+\\\", RowBox[{\\\"JJ\\\", \\\" \\\", \\\"p2\\\"}], \\\"+\\\
\", RowBox[{\\\"KK\\\", \\\" \\\", \\\"p3\\\"}]}]\\) \:5e94\:8be5\:662f\:7531\
\:4e09\:4e2a\:65cb\:8f6c\:8f74\:7d22\:5f15\:7ec4\:6210\:7684\:5217\:8868.\"", 
   2, 366, 5, 28075062962121508272, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.8811996675348835`*^9, 3.881199684328273*^9}, 
   3.881199721039489*^9, 3.886535508831873*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[364]:=",ExpressionUUID->"097009e0-b0c8-4a50-\
a2a8-1c4dcabbe018"],

Cell[BoxData[
 TagBox[
  RowBox[{"EulerMatrix", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "[", "s", "]"}], ",", 
      RowBox[{"\[Beta]", "[", "s", "]"}], ",", 
      RowBox[{"\[Gamma]", "[", "s", "]"}]}], "}"}], ",", 
    RowBox[{"p0", "+", 
     RowBox[{"II", " ", "p1"}], "+", 
     RowBox[{"JJ", " ", "p2"}], "+", 
     RowBox[{"KK", " ", "p3"}]}]}], "]"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8806176669280453`*^9, 3.880617738680109*^9}, {
   3.8806178863854094`*^9, 3.8806179092439923`*^9}, {3.8806179516717224`*^9, 
   3.880617956634055*^9}, {3.881199667400702*^9, 3.8811996843222246`*^9}, 
   3.881199721033497*^9, 3.886535508840848*^9},
 CellLabel->
  "Out[366]//MatrixForm=",ExpressionUUID->"f1f512f5-6e65-4396-9889-\
cd183097238e"],

Cell[BoxData[
 FormBox[
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"cos", "(", 
           RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["\[Beta]", "\[Prime]",
            MultilineFunction->None], "(", "s", ")"}]}]}], "-", 
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{"sin", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{"sin", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}], "-", 
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}], "+", 
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{"sin", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}], "0", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SuperscriptBox["\[Alpha]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}], "-", 
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}], "-", 
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{"sin", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Alpha]", "\[Prime]",
          MultilineFunction->None], "(", "s", ")"}], "+", 
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}], "0"},
      {"0", 
       RowBox[{
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{"sin", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}], "-", 
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}], "+", 
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{"sin", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}], "-", 
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{"sin", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}], "0", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SuperscriptBox["\[Alpha]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}], "-", 
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"cos", "(", 
           RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["\[Beta]", "\[Prime]",
            MultilineFunction->None], "(", "s", ")"}]}]}], "-", 
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{"sin", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Alpha]", "\[Prime]",
          MultilineFunction->None], "(", "s", ")"}], "+", 
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}], "0"},
      {"0", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"sin", "(", 
           RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["\[Beta]", "\[Prime]",
            MultilineFunction->None], "(", "s", ")"}]}]}], "-", 
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{"cos", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}], "-", 
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{"cos", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}], "+", 
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{"cos", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}], "0", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SuperscriptBox["\[Alpha]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}], "-", 
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{"cos", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}], "-", 
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Alpha]", "\[Prime]",
          MultilineFunction->None], "(", "s", ")"}], "+", 
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}], "0"},
      {"0", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"cos", "(", 
           RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["\[Beta]", "\[Prime]",
            MultilineFunction->None], "(", "s", ")"}]}]}], "-", 
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{"cos", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{"cos", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}], "-", 
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}], "+", 
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{"cos", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}], "0", 
       RowBox[{
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}], "-", 
        RowBox[{
         SuperscriptBox["\[Alpha]", "\[Prime]",
          MultilineFunction->None], "(", "s", ")"}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Beta]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}], "-", 
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"\[Alpha]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{"cos", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Alpha]", "\[Prime]",
          MultilineFunction->None], "(", "s", ")"}], "-", 
        RowBox[{
         RowBox[{"sin", "(", 
          RowBox[{"\[Beta]", "(", "s", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["\[Gamma]", "\[Prime]",
           MultilineFunction->None], "(", "s", ")"}]}]}], "0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.8806176669280453`*^9, 3.880617738680109*^9}, {
   3.8806178863854094`*^9, 3.8806179092439923`*^9}, {3.8806179516717224`*^9, 
   3.880617956634055*^9}, {3.881199667400702*^9, 3.8811996843222246`*^9}, 
   3.881199721033497*^9, 3.8865355090991554`*^9},
 CellLabel->
  "Out[367]//TraditionalForm=",ExpressionUUID->"29a7b887-2f18-4a39-8cf0-\
00edee347fc7"]
}, Open  ]]
},
WindowSize->{1478, 1348},
WindowMargins->{{Automatic, 336}, {Automatic, 0}},
Magnification:>1.2 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (2021\:5e747\:670823\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"6c6e8911-c9ed-4513-b0ec-f6825b2cb492"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4519, 82, 372, "Input",ExpressionUUID->"97714921-b194-4e47-a6f9-be6fd417cc6e"],
Cell[5080, 104, 8495, 205, 581, "Input",ExpressionUUID->"a82c8a22-6c33-4911-b414-4ef9cd33e49b"],
Cell[CellGroupData[{
Cell[13600, 313, 8471, 200, 449, "Input",ExpressionUUID->"8be6f0e6-b21e-40b7-b26f-84a5a4cddce5"],
Cell[22074, 515, 4610, 97, 94, "Output",ExpressionUUID->"4f52666c-b6cd-412d-a8c4-7fab02d166ce"],
Cell[26687, 614, 4608, 97, 94, "Output",ExpressionUUID->"4834ba28-a9f8-4310-96bb-5d21867a6e7d"],
Cell[31298, 713, 4042, 85, 106, "Output",ExpressionUUID->"95e96177-a958-431d-8e8d-3fa70e7d3d74"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35377, 803, 4561, 119, 389, "Input",ExpressionUUID->"bfc948b6-7d70-40f7-a763-e20389ce82e8"],
Cell[39941, 924, 3683, 101, 106, "Output",ExpressionUUID->"8f509f4c-3890-4646-adff-1a433f08f029"],
Cell[43627, 1027, 6403, 171, 94, "Output",ExpressionUUID->"9ec6c715-a488-4a15-b144-c26ae541c48c"]
}, Open  ]],
Cell[50045, 1201, 175, 3, 35, "Input",ExpressionUUID->"2add9f40-5bec-4cf7-b74d-0d22059150f5"],
Cell[CellGroupData[{
Cell[50245, 1208, 3322, 91, 185, "Input",ExpressionUUID->"242df851-d0c3-4e0c-81b5-7c03dee13686"],
Cell[53570, 1301, 682, 16, 39, "Output",ExpressionUUID->"ae372120-a7a8-4a97-bc25-e74b4204fcef"],
Cell[54255, 1319, 682, 13, 34, "Message",ExpressionUUID->"097009e0-b0c8-4a50-a2a8-1c4dcabbe018"],
Cell[54940, 1334, 826, 21, 54, "Output",ExpressionUUID->"f1f512f5-6e65-4396-9889-cd183097238e"],
Cell[55769, 1357, 13364, 360, 283, "Output",ExpressionUUID->"29a7b887-2f18-4a39-8cf0-00edee347fc7"]
}, Open  ]]
}
]
*)

